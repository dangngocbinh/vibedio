# Video Production Workflow - Correct Sequence

## ğŸ“‹ QUAN TRá»ŒNG: Thá»© tá»± thá»±c hiá»‡n

TÃ i liá»‡u nÃ y mÃ´ táº£ **THá»¨ Tá»° CHÃNH XÃC** cá»§a workflow Ä‘á»ƒ trÃ¡nh lá»—i.

---

## âš ï¸ Váº¤N Äá»€ THÆ¯á»œNG Gáº¶P

**âŒ SAI:** Cháº¡y `sync` trÆ°á»›c khi add sections vÃ  scenes
- Sync command Cáº¦N sections/scenes Ä‘Ã£ tá»“n táº¡i Ä‘á»ƒ update timing
- Cháº¡y sync sá»›m â†’ KhÃ´ng cÃ³ gÃ¬ Ä‘á»ƒ sync â†’ Lá»—i hoáº·c káº¿t quáº£ sai

**âœ… ÄÃšNG:** Add sections â†’ Add scenes â†’ Sync timing
- Táº¡o cáº¥u trÃºc trÆ°á»›c (sections, scenes vá»›i text)
- Sync sau Ä‘á»ƒ update timing chÃ­nh xÃ¡c

---

## ğŸ¯ WORKFLOW ÄÃšNG (8 BÆ¯á»šC)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. XÃC NHáº¬N ASPECT RATIO                   â”‚
â”‚    9:16, 16:9, 1:1, 4:5                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Táº O Ká»ŠCH Báº¢N FULL TEXT                  â”‚
â”‚    â€¢ Viáº¿t full text (topic â†’ text)          â”‚
â”‚    â€¢ Init project (táº¡o script.json)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â­ CHECKPOINT 1: CONFIRM TEXT               â”‚
â”‚    User review text â†’ OK má»›i tiáº¿p           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Táº O GIá»ŒNG Äá»ŒC                            â”‚
â”‚    3.1: Generate voice (voice.mp3, .json)   â”‚
â”‚    3.2: Update voice info vÃ o script        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Táº O Cáº¤U TRÃšC Ká»ŠCH Báº¢N âš ï¸                 â”‚
â”‚    4.1: Add Sections (intro, p1, p2, ...)   â”‚
â”‚    4.2: Add Scenes (scenes cho má»—i section) â”‚
â”‚    4.3: Sync Timing âœ… (SAU 4.1 vÃ  4.2)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. TÃŒM TÃ€I NGUYÃŠN                           â”‚
â”‚    Download 10 options/scene â†’ downloads/   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. REVIEW MEDIA (Script Planner)            â”‚
â”‚    User xem media + timing                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â­ CHECKPOINT 2: CONFIRM MEDIA              â”‚
â”‚    User confirm OK má»›i tiáº¿p                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6.5. IMPORT SELECTED RESOURCES              â”‚
â”‚    Chá»n best â†’ imports/ â†’ cleanup downloads/â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. BUILD TIMELINE                           â”‚
â”‚    video-editor â†’ project.otio               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Má» REMOTION STUDIO                       â”‚
â”‚    http://localhost:3000                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ CHI TIáº¾T BÆ¯á»šC 4 (QUAN TRá»ŒNG!)

**BÆ°á»›c 4 lÃ  bÆ°á»›c Dá»„ NHáº¦M nháº¥t. Pháº£i thá»±c hiá»‡n ÄÃšNG THá»¨ Tá»°:**

### 4.1: Add Sections (Táº O sections)

**Má»¥c Ä‘Ã­ch:** Táº¡o sections trong script.json

**Commands:**
```bash
# Táº¡o text file cho section
node scripts/write-text.js --file "sec_intro.txt" --text "..."

# Add section
python3 script_cli.py add-section \
  --script "public/projects/demo/script.json" \
  --voice "public/projects/demo/voice.json" \
  --id "intro" --name "Giá»›i thiá»‡u" \
  --text "sec_intro.txt" --pace "medium"
```

**Láº·p láº¡i cho táº¥t cáº£ sections.**

---

### 4.2: Add Scenes (Táº O scenes)

**Má»¥c Ä‘Ã­ch:** Táº¡o scenes cho tá»«ng section

**Commands:**
```bash
# Táº¡o scenes definition file
node scripts/write-text.js --file "scenes_intro.json" --text '[
  {"id": "intro_1", "text": "...", "visuals": [...]}
]'

# Add scenes (single section)
python3 script_cli.py add-scenes \
  --script "..." --voice "..." \
  --section "intro" \
  --scenes-file "scenes_intro.json"

# Add scenes (multiple sections - KHUYáº¾N NGHá»Š)
node scripts/add-scenes-batch.js \
  --script "..." --voice "..." \
  --section "intro" "scenes_intro.json" \
  --section "p1" "scenes_p1.json" \
  --section "p2" "scenes_p2.json"
```

---

### 4.3: Sync Timing (UPDATE timing)

**âš ï¸ BÆ¯á»šC NÃ€Y CHá»ˆ CHáº Y SAU KHI 4.1 VÃ€ 4.2 HOÃ€N Táº¤T**

**Má»¥c Ä‘Ã­ch:** Update timing chÃ­nh xÃ¡c cho sections/scenes Ä‘Ã£ táº¡o

**Command:**
```bash
python3 script_cli.py sync \
  --script "public/projects/demo/script.json" \
  --voice "public/projects/demo/voice.json"
```

**Chá»©c nÄƒng:**
- âœ… Äá»c sections vÃ  scenes ÄÃƒ CÃ“
- âœ… TÃ¬m timestamps cho text cá»§a tá»«ng scene (fuzzy matching)
- âœ… Update startTime, endTime, duration cho scenes
- âœ… Update startTime, endTime, duration cho sections
- âœ… Update total duration

**âŒ KHÃ”NG lÃ m:**
- KHÃ”NG táº¡o sections/scenes má»›i
- KHÃ”NG tá»± Ä‘á»™ng chia scenes
- KHÃ”NG cháº¡y trÆ°á»›c khi cÃ³ sections/scenes

---

## ğŸ” KIá»‚M TRA WORKFLOW ÄÃšNG

**Sau BÆ°á»›c 3 (Generate Voice):**
- âœ… CÃ³ file `voice.mp3`
- âœ… CÃ³ file `voice.json` vá»›i timestamps
- âœ… `script.json` cÃ³ voice info
- âŒ CHÆ¯A cÃ³ sections
- âŒ CHÆ¯A cÃ³ scenes

**Sau BÆ°á»›c 4.1 (Add Sections):**
- âœ… `script.json` cÃ³ `sections[]`
- âœ… Má»—i section cÃ³ `id`, `name`, `text`
- âš ï¸ Timing sections CHÆ¯A chÃ­nh xÃ¡c (chá»‰ sÆ¡ bá»™)
- âŒ CHÆ¯A cÃ³ scenes

**Sau BÆ°á»›c 4.2 (Add Scenes):**
- âœ… Má»—i section cÃ³ `scenes[]`
- âœ… Má»—i scene cÃ³ `id`, `text`, `visuals`
- âš ï¸ Timing scenes CHÆ¯A chÃ­nh xÃ¡c (chá»‰ sÆ¡ bá»™)

**Sau BÆ°á»›c 4.3 (Sync):**
- âœ… Timing sections CHÃNH XÃC
- âœ… Timing scenes CHÃNH XÃC (khá»›p vá»›i voice)
- âœ… Total duration = voice duration
- âœ… Ready cho bÆ°á»›c find resources

---

## ğŸš¨ Lá»–I THÆ¯á»œNG Gáº¶P

### Lá»—i 1: "No sections found to sync"
**NguyÃªn nhÃ¢n:** Cháº¡y sync trÆ°á»›c khi add-section
**Giáº£i phÃ¡p:** Cháº¡y add-section trÆ°á»›c, sau Ä‘Ã³ má»›i sync

### Lá»—i 2: "No scenes found in section"
**NguyÃªn nhÃ¢n:** Cháº¡y sync sau add-section nhÆ°ng trÆ°á»›c add-scenes
**Giáº£i phÃ¡p:** Cháº¡y add-scenes cho Táº¤T Cáº¢ sections, sau Ä‘Ã³ má»›i sync

### Lá»—i 3: Duration mismatch
**NguyÃªn nhÃ¢n:** KhÃ´ng cháº¡y sync sau khi add scenes
**Giáº£i phÃ¡p:** LuÃ´n cháº¡y sync sau add-scenes Ä‘á»ƒ timing chÃ­nh xÃ¡c

### Lá»—i 4: Terminal hang khi add scenes
**NguyÃªn nhÃ¢n:** DÃ¹ng heredoc hoáº·c cháº¡y nhiá»u add-scenes vá»›i `&&`
**Giáº£i phÃ¡p:** DÃ¹ng `write-text.js` vÃ  `add-scenes-batch.js`

---

## âœ… CHECKLIST AGENT

Agent nÃªn kiá»ƒm tra trÆ°á»›c khi má»—i bÆ°á»›c:

**TrÆ°á»›c khi Sync (BÆ°á»›c 4.3):**
- [ ] ÄÃ£ add-section cho Táº¤T Cáº¢ sections chÆ°a?
- [ ] ÄÃ£ add-scenes cho Táº¤T Cáº¢ sections chÆ°a?
- [ ] script.json cÃ³ sections[] vÃ  scenes[] chÆ°a?

**Sau khi Sync:**
- [ ] Táº¥t cáº£ scenes cÃ³ startTime/endTime chÆ°a?
- [ ] Total duration khá»›p vá»›i voice duration chÆ°a?
- [ ] Kiá»ƒm tra script.json cÃ³ lá»—i format khÃ´ng?

**TrÆ°á»›c khi Find Resources (BÆ°á»›c 5):**
- [ ] ÄÃ£ sync timing chÆ°a?
- [ ] Táº¥t cáº£ scenes cÃ³ duration chÃ­nh xÃ¡c chÆ°a?

---

## ğŸ“š TÃ€I LIá»†U LIÃŠN QUAN

- **SKILL.md**: Full documentation vá»›i examples
- **scripts/README.md**: Helper scripts documentation
- **script_cli.py**: CLI reference vá»›i all commands

---

## ğŸ“ BEST PRACTICES

1. **LuÃ´n dÃ¹ng write-text.js** thay vÃ¬ heredoc
2. **LuÃ´n dÃ¹ng add-scenes-batch.js** cho 3+ sections
3. **LuÃ´n sync SAU khi add táº¥t cáº£ sections vÃ  scenes**
4. **Kiá»ƒm tra script.json** sau má»—i bÆ°á»›c quan trá»ng
5. **Verify timing** trÆ°á»›c khi find resources

---

## ğŸ”— QUICK REFERENCE

```bash
# BÆ°á»›c 4.1: Add Section
node scripts/write-text.js --file "sec_intro.txt" --text "..."
python3 script_cli.py add-section --script "..." --voice "..." --id "intro" --name "Intro" --text "sec_intro.txt"

# BÆ°á»›c 4.2: Add Scenes (batch)
node scripts/write-text.js --file "scenes_intro.json" --text '[...]'
node scripts/add-scenes-batch.js --script "..." --voice "..." --section "intro" "scenes_intro.json" --section "p1" "scenes_p1.json"

# BÆ°á»›c 4.3: Sync
python3 script_cli.py sync --script "..." --voice "..."
```

---

**Ghi nhá»›:** ADD FIRST, SYNC LAST! ğŸ¯
