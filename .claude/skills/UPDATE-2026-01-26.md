# Cáº­p nháº­t Skills - 26/01/2026

## ğŸ“ Tá»•ng quan

ÄÃ£ cáº­p nháº­t 2 skills chÃ­nh:
1. **Video Script Generator** - ThÃªm music selection guidelines
2. **Voice Generation** - ThÃªm style instruction cho Gemini

---

## ğŸµ Video Script Generator - Music Selection

### Cáº­p nháº­t chÃ­nh

#### 1. Cáº¥u trÃºc Music Config má»›i

```json
{
  "music": {
    "query": "ambient calm peaceful",
    "mood": "calm|energetic|dramatic|uplifting|dark|happy|sad|mysterious",
    "genre": "ambient|cinematic|electronic|acoustic|corporate|epic",
    "volume": 0.15,
    "fadeIn": 1.0,
    "fadeOut": 2.0,
    "notes": "Nháº¡c ná»n nÃªn cÃ³ volume tháº¥p (0.1-0.2)..."
  }
}
```

**Thay Ä‘á»•i tá»« phiÃªn báº£n cÅ©:**
- âœ… ThÃªm `query` - Search query cho Pixabay
- âœ… ThÃªm `genre` - Thá»ƒ loáº¡i nháº¡c cá»¥ thá»ƒ
- âœ… ThÃªm `fadeIn`, `fadeOut` - Fade transitions
- âœ… Má»Ÿ rá»™ng `mood` options
- âŒ XÃ³a `suggestions` array (khÃ´ng cáº§n thiáº¿t)

#### 2. Music Selection Guidelines

ÄÃ£ thÃªm section chi tiáº¿t vá» cÃ¡ch chá»n nháº¡c cho tá»«ng loáº¡i video:

**Facts Video:**
- Query: `"ambient corporate minimal"`
- Volume: 0.10 - 0.12 (ráº¥t nhá»)
- Má»¥c Ä‘Ã­ch: KhÃ´ng Ã¡t voice, há»— trá»£ thÃ´ng tin

**Listicle Video:**
- Query: `"upbeat corporate energetic"`
- Volume: 0.12 - 0.15 (vá»«a pháº£i)
- Má»¥c Ä‘Ã­ch: Táº¡o nÄƒng lÆ°á»£ng, giá»¯ pace

**Motivation Video:**
- Query: `"cinematic inspiring emotional"`
- Volume: 0.15 - 0.20 (cao hÆ¡n)
- Má»¥c Ä‘Ã­ch: Táº¡o cáº£m xÃºc, inspiring

**Story Video:**
- Query: `"cinematic mysterious dramatic"`
- Volume: 0.12 - 0.18 (tÃ¹y scene)
- Má»¥c Ä‘Ã­ch: Build tension, theo cáº£m xÃºc

#### 3. Mood-Genre Matrix

Báº£ng káº¿t há»£p mood + genre tá»‘i Æ°u:

| Mood | Best Genres | Pixabay Query Example |
|------|-------------|----------------------|
| calm | ambient, acoustic | `"ambient calm peaceful"` |
| energetic | electronic, corporate | `"electronic upbeat energetic"` |
| dramatic | cinematic, epic | `"cinematic dramatic tension"` |
| uplifting | cinematic, corporate | `"cinematic inspiring uplifting"` |

#### 4. Common Mistakes & Best Practices

**TrÃ¡nh:**
- âŒ Volume quÃ¡ cao â†’ Ãt voice
- âŒ Nháº¡c cÃ³ vocal â†’ Conflict vá»›i voice-over
- âŒ Query quÃ¡ chung â†’ Káº¿t quáº£ khÃ´ng chÃ­nh xÃ¡c

**Best Practices:**
- âœ… Voice pháº£i rÃµ hÆ¡n music Ã­t nháº¥t 2x
- âœ… Match energy vá»›i pace cá»§a script
- âœ… Specific query cÃ ng tá»‘t
- âœ… LuÃ´n dÃ¹ng fadeIn/fadeOut

---

## ğŸ¤ Voice Generation - Style Instruction

### Cáº­p nháº­t chÃ­nh

#### 1. ThÃªm Style Instruction cho Gemini

Gemini API giá» há»— trá»£ **style instruction** - mÃ´ táº£ tá»± do vá» cÃ¡ch giá»ng nÃ³i Ä‘Æ°á»£c thá»ƒ hiá»‡n.

**CLI má»›i:**
```bash
node .claude/skills/voice-generation/scripts/generate-voice.js \
  --text "Your text here" \
  --provider "gemini" \
  --voiceId "Charon" \
  --styleInstruction "Tráº§m â€“ áº¥m â€“ cháº­m â€“ ráº¥t Ä‘á»i" \
  --outputDir "public/projects/folder"
```

#### 2. Style Instruction Examples

```javascript
// Motivation content
"Tráº§m â€“ áº¥m â€“ cháº­m â€“ ráº¥t Ä‘á»i"

// Energetic content
"Vui tÆ°Æ¡i â€“ nÄƒng Ä‘á»™ng â€“ nhiá»‡t tÃ¬nh"

// Professional content
"NghiÃªm tÃºc â€“ chuyÃªn nghiá»‡p â€“ rÃµ rÃ ng"

// Meditation content
"Nháº¹ nhÃ ng â€“ Ãªm dá»‹u â€“ thÆ° giÃ£n"
```

#### 3. Implementation Details

**Code changes in `generate-voice.js`:**

```javascript
// Parse styleInstruction from command line
const styleInstruction = ARGS.styleInstruction || null;

// Pass to Gemini generator
result = await generateGemini(
  finalText, 
  voiceId, 
  emotion, 
  baseFilename, 
  styleInstruction
);

// In generateGemini function
const payload = {
  contents: [{
    role: "user",
    parts: [{
      // Prepend style instruction to text
      text: styleInstruction ? `${styleInstruction}\n\n${text}` : text
    }]
  }],
  generationConfig: {
    responseModalities: ["audio"],
    speechConfig: {
      voiceConfig: {
        prebuiltVoiceConfig: {
          voiceName: voiceName
        }
      }
    }
  }
};
```

**Metadata saved:**
```json
{
  "text": "...",
  "provider": "gemini",
  "voiceId": "Charon",
  "styleInstruction": "Tráº§m â€“ áº¥m â€“ cháº­m â€“ ráº¥t Ä‘á»i",
  "model": "gemini-2.5-pro-preview-tts",
  "audioFile": "voice.wav",
  "duration": 45.2,
  "timestamps": null
}
```

#### 4. Updated Voice Config in Script JSON

```json
{
  "voice": {
    "provider": "gemini",
    "voiceId": "Charon",
    "speed": 0.95,
    "styleInstruction": "Tráº§m â€“ áº¥m â€“ cháº­m â€“ ráº¥t Ä‘á»i",
    "notes": "Male voice, deep and warm tone..."
  }
}
```

---

## ğŸ“¦ Files Changed

### Video Script Generator Skill
- âœ… `.claude/skills/video-script-generator/SKILL.md` - Added music guidelines
- âœ… `.claude/skills/video-script-generator/examples/facts-video-example.json` - New example
- âœ… `.claude/skills/video-script-generator/examples/motivation-video-example.json` - New example

### Voice Generation Skill
- âœ… `.claude/skills/voice-generation/SKILL.md` - Added style instruction docs
- âœ… `.claude/skills/voice-generation/scripts/generate-voice.js` - Implemented style instruction
- âœ… `.claude/skills/voice-generation/scripts/list-voices.js` - Updated voice list
- âœ… `.claude/skills/voice-generation/scripts/test-style-instruction.sh` - Test script

---

## ğŸ§ª Testing

### Test Music Selection

Táº¡o script vá»›i music config má»›i:
```bash
# Example sáº½ cÃ³ music config vá»›i query, mood, genre
cat .claude/skills/video-script-generator/examples/facts-video-example.json
```

### Test Style Instruction

Run test script:
```bash
./.claude/skills/voice-generation/scripts/test-style-instruction.sh
```

Hoáº·c test manual:
```bash
node .claude/skills/voice-generation/scripts/generate-voice.js \
  --text "Test text" \
  --provider "gemini" \
  --voiceId "Leda" \
  --styleInstruction "Tráº§m â€“ áº¥m â€“ cháº­m â€“ ráº¥t Ä‘á»i" \
  --outputDir "./test-output"
```

---

## ğŸ“š Documentation Updates

### SKILL.md Updates

**Video Script Generator:**
- Added "MUSIC SELECTION GUIDELINES" section (150+ lines)
- Added Pixabay search strategy
- Added music by video type
- Added volume guidelines
- Added mood-genre matrix
- Added common mistakes & best practices

**Voice Generation:**
- Added "Style Instruction (Gemini Only)" section
- Updated CLI examples
- Added style instruction examples
- Updated provider list to include `gemini`

---

## ğŸ¯ Usage Examples

### Example 1: Facts Video with Calm Music

```json
{
  "voice": {
    "provider": "gemini",
    "voiceId": "Charon",
    "styleInstruction": "NghiÃªm tÃºc â€“ chuyÃªn nghiá»‡p â€“ rÃµ rÃ ng"
  },
  "music": {
    "query": "ambient calm peaceful",
    "mood": "calm",
    "genre": "ambient",
    "volume": 0.12
  }
}
```

### Example 2: Motivation Video with Epic Music

```json
{
  "voice": {
    "provider": "gemini",
    "voiceId": "Charon",
    "styleInstruction": "Tráº§m â€“ áº¥m â€“ cháº­m â€“ ráº¥t Ä‘á»i"
  },
  "music": {
    "query": "cinematic inspiring emotional",
    "mood": "uplifting",
    "genre": "cinematic",
    "volume": 0.18
  }
}
```

---

## ğŸ”„ Migration Guide

### Updating Existing Scripts

**Old music config:**
```json
{
  "music": {
    "mood": "calm",
    "volume": 0.15,
    "suggestions": ["ambient-calm-1"]
  }
}
```

**New music config:**
```json
{
  "music": {
    "query": "ambient calm peaceful",
    "mood": "calm",
    "genre": "ambient",
    "volume": 0.12,
    "fadeIn": 1.5,
    "fadeOut": 2.5,
    "notes": "Nháº¡c ná»n nháº¹ nhÃ ng..."
  }
}
```

**Old voice config:**
```json
{
  "voice": {
    "provider": "openai",
    "voiceId": "onyx"
  }
}
```

**New voice config (with Gemini):**
```json
{
  "voice": {
    "provider": "gemini",
    "voiceId": "Charon",
    "styleInstruction": "NghiÃªm tÃºc â€“ chuyÃªn nghiá»‡p"
  }
}
```

---

## âœ… Checklist

- [x] Updated music config structure
- [x] Added music selection guidelines
- [x] Added mood-genre matrix
- [x] Added volume guidelines
- [x] Implemented style instruction for Gemini
- [x] Updated generate-voice.js script
- [x] Updated SKILL.md documentation
- [x] Created example JSON files
- [x] Created test script
- [x] Added Vue developer comments in code

---

## ğŸš€ Next Steps

1. **Test vá»›i real projects** - Táº¡o video thá»±c táº¿ Ä‘á»ƒ verify
2. **Collect feedback** - Xem music selection cÃ³ chÃ­nh xÃ¡c khÃ´ng
3. **Fine-tune style instructions** - Test nhiá»u style khÃ¡c nhau
4. **Add more examples** - Listicle, Story video examples

---

## ğŸ“ Support

Náº¿u cÃ³ váº¥n Ä‘á»:
1. Check `.env` file cÃ³ Ä‘á»§ API keys
2. Run test script Ä‘á»ƒ verify
3. Check console logs cho error messages
4. Review SKILL.md documentation
